
<!doctype html>
<html amp lang="en">

<head>
    <meta charset="utf-8">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script>
    <script async custom-template="amp-mustache" src="https://cdn.ampproject.org/v0/amp-mustache-0.2.js"></script>
    <link rel="shortcut icon" href="https://shotcutdotcom.github.io/static/images/favicon.ico" type="image/png">
    <title>How to Design the data structures for a social network - Blog - Find Best Reads of All Time on AskGif</title>

    <link rel="canonical" href="https://askgif.com/blog/1688/how-to-design-the-data-structures-for-a-social-network/">

    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "NewsArticle",
        "mainEntityOfPage": "https://askgif.com/",
        "headline": "AskGif",
        "datePublished": "2020/11/20",
        "dateModified":  "2020/11/20",
        "description": "Share this How to Design the data structures for a social network Blog and explore more",
        "author": {
        "@type": "Person",
        "name": "Sumit Chourasia"
        },
        "publisher": {
        "@type": "Organization",
        "name": "Askgif",
        "logo": {
        "@type": "ImageObject",
        "url": "https://raw.githubusercontent.com/sumitc91/data/master/askgif-static/askgif_logo.png"
        }
        },
        "image": {
        "@type": "ImageObject",
        "url": "https://raw.githubusercontent.com/sumitc91/AmpImage/main/Blogs/031621dc-30c0-4e0d-ba31-1f20a3884f5c.jpg",
        "height": 1280,
        "width": 857
        }
        }
    </script>
    <style amp-boilerplate>
        body {
            -webkit-animation: -amp-start 8s steps(1, end) 0s 1 normal both;
            -moz-animation: -amp-start 8s steps(1, end) 0s 1 normal both;
            -ms-animation: -amp-start 8s steps(1, end) 0s 1 normal both;
            animation: -amp-start 8s steps(1, end) 0s 1 normal both
        }

        @-webkit-keyframes -amp-start {
            from {
                visibility: hidden
            }

            to {
                visibility: visible
            }
        }

        @-moz-keyframes -amp-start {
            from {
                visibility: hidden
            }

            to {
                visibility: visible
            }
        }

        @-ms-keyframes -amp-start {
            from {
                visibility: hidden
            }

            to {
                visibility: visible
            }
        }

        @-o-keyframes -amp-start {
            from {
                visibility: hidden
            }

            to {
                visibility: visible
            }
        }

        @keyframes -amp-start {
            from {
                visibility: hidden
            }

            to {
                visibility: visible
            }
        }
    </style>
    <noscript>
        <style amp-boilerplate>
            body {
                -webkit-animation: none;
                -moz-animation: none;
                -ms-animation: none;
                animation: none
            }
        </style>
    </noscript>
    <style amp-custom=''>
        * {
            box-sizing: border-box;
            font-family: 'Roboto';
            transition: all 0.2s linear;
            font-size: 16px;
        }

        html,
        body {
            margin: 0px;
            padding: 0px;
        }

        .content-width {
            width: 80%;
        }

        .content {
            margin: 0 auto;
            padding: 50px 0px;
            line-height: 160%;
        }

        h1 {
            font-size: 240%;
            line-height: 120%;
            margin: 20px 0px;
        }

        h2 {
            font-size: 140%;
            margin: 30px 0px;
        }

        .clearfix {
            clear: both;
        }

        .subtext {
            text-align: left;
            font-weight: 400;
            color: #a5a5a5;
            font-size: 90%;
        }

        .branding {
            font-size: 90%;
            color: #fff;
        }

            .branding a {
                color: inherit;
            }

                .branding a:hover {
                    color: #19B5FE;
                }

        .button {
            padding: 10px 15px;
            text-decoration: none;
            color: #fff;
            background: #19B5FE;
            font-weight: 700;
            text-align: center;
        }

            .button:hover {
                background: #3ebf43;
            }

        /* Header */
        header,
        footer,
        #sidebar {
            background: #2c3e50;
        }

        header {
            padding: 10px 0px;
            position: sticky;
            top: 0;
            z-index: 999;
        }

        #sidebar {
            width: 300px;
            padding: 1.5rem;
        }

        .sidebar-menu {
            padding: 0px;
            margin: 0px;
        }

        .amp-custom-sidebar-header {
            line-height: 3.5rem;
            min-height: 3.5rem;
            color: #fff;
        }

        #sidebar-close {
            cursor: pointer;
        }

        .sidevar-nav-item {
            padding: 10px 0px;
            margin: 0px;
            display: block;
            list-style: none;
            color: #021425;
            text-transform: capitalize;
            letter-spacing: .6px;
            line-height: 2.0625;
            cursor: pointer;
            text-decoration: none;
            color: #fff;
        }

            .sidevar-nav-item:hover {
                color: #19B5FE;
            }

        .menu {
            display: flex;
            justify-content: space-between;
            margin: 0 auto;
        }

        .logo {
            width: 200px;
        }

        #sidebar-menu-btn {
            background: 0 0;
            border: 0;
            color: #fff;
            font-weight: 700;
            font-size: 28px;
        }

        /* POST */
        #article-wrapper {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
        }

        .article {
            flex-basis: 70%;
            padding-right: 30px;
            border-right: 1px solid #e3e3e3;
        }

            .article h1 {
                margin-top: 0px;
            }

        .article-image,
        .article-body {
            margin: 20px 0px;
            width: 340px;
        }

        .author-info {
            color: #9d9d9d;
            font-weight: bold;
        }

        .article a {
            color: inherit;
        }

        a {
            text-decoration: none;
            color: white;
        }

        pre {
            font-family: Consolas, Menlo, Monaco, Lucida Console, Liberation Mono, DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace, serif;
            margin-bottom: 10px;
            overflow: auto;
            width: auto;
            padding: 5px;
            background-color: #eee;
            width: 650px !ie7;
            padding-bottom: 20px !ie7;
            max-height: 600px;
        }

        .article a.button {
            margin: 20px 10px 20px 0px;
            display: inline-block;
            width: 120px;
        }

            .article a.button,
            .article a.button:hover {
                color: #fff;
            }

        .article a:hover {
            color: #19B5FE;
        }

        #additional-info {
            flex-basis: 30%;
            padding-left: 30px;
        }

            #additional-info:before {
                display: block;
                height: 6px;
                background-color: #2c3e50;
                content: ' ';
                width: 50px;
                margin-left: 0;
                margin-bottom: 20px;
            }

        .promo,
        .related-box ul li {
            border: 1px solid #e3e3e3;
        }

        .promo {
            padding: 10px;
            margin-top: 20px;
        }

        .article-meta ul,
        .related-box ul {
            padding: 0px;
            margin: 0px;
        }

        .related-box a {
            text-decoration: none;
            color: inherit;
        }

            .related-box a.imp-link {
                color: #3ebf43;
                font-weight: 700;
            }

        .related-box ul li {
            list-style: none;
            padding: 10px;
        }

            .related-box ul li:hover,
            .related-box a:hover {
                text-decoration: underline;
                background: #ebebeb;
            }

        .article-meta {
            margin: 30px 0px;
        }

            .article-meta ul {
                display: flex;
                flex-direction: row;
            }

        .article .article-meta a.tag {
            margin-right: 5px;
            background: #ebebeb;
            font-size: 90%;
            text-decoration: none;
            padding: 5px;
            color: #414141;
            text-transform: uppercase;
        }

        .article .article-meta .tag:hover {
            background: #dadada;
        }

        .article-meta li {
            list-style: none;
        }

        .blockquote-wrapper {
            position: relative;
        }

        .blockquote {
            margin-top: 50px;
            margin-bottom: 50px;
            font-size: 90%;
            font-style: italic;
            text-align: justify;
        }

            .blockquote::before {
                content: "“";
                position: absolute;
                top: 0.25em;
                left: -0.15em;
                color: #e7e6e4;
                font-size: 170px;
                z-index: -1;
            }

        cite {
            display: block;
            text-align: right;
            padding: 10px 0px;
        }

        .amp-components .component {
            margin: 30px 0px;
            position: relative;
            overflow: hidden;
        }

        .color-darkturquoise {
            background-color: darkturquoise;
        }
        /* Footer */
        footer {
            color: #fff;
            text-align: center;
        }

        .article {
            width: 100%;
        }

        #additional-info {
            width: 100%;
        }

        @media only screen and (max-width: 1024px) {
            h1 {
                font-size: 140%;
            }

            .article {
                padding-right: 20px;
            }

            #additional-info {
                padding-left: 20px;
            }

            .related-box ul li, .promo p, .promo a {
                font-size: 90%;
            }
        }

        @media only screen and (max-width: 768px) {
            .article,
            #additional-info {
                border: 0px;
                flex-basis: 100%;
                padding: 0px;
                margin-bottom: 30px;
            }

            .logo {
                width: 160px;
            }

            h1 {
                font-size: 160%;
            }

            .article a.button,
            .article .article-meta a.tag li {
                font-size: 90%;
            }
        }

        @media only screen and (max-width: 600px) {
            h1 {
                font-size: 120%;
            }

            .content-width {
                width: 90%;
            }

            .content {
                padding: 30px 0px;
            }

            .logo {
                width: 140px;
            }

            header {
                padding: 5px 0px;
            }

            #article-wrapper {
                flex-direction: column;
            }

            .blockquote {
                margin: 50px 0px;
                font-size: 100%;
            }

            .article-meta ul {
                flex-wrap: wrap;
            }

            .article-meta a.tag {
                margin-bottom: 10px;
            }

            .article a.button {
                margin: 10px 10px 10px 0px;
            }

            .branding p, .branding a {
                font-size: 14px;
            }
        }
    </style>
     <script async custom-element="amp-auto-ads"
            src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
    <script async custom-element="amp-ad" src="https://cdn.ampproject.org/v0/amp-ad-0.1.js"></script> 
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
</head>

<body>
     <amp-auto-ads type="adsense"
                  data-ad-client="ca-pub-1068871795581451">
    </amp-auto-ads> 
    <amp-analytics type="googleanalytics">
        <script type="application/json">
            {
            "vars": {
            "account": "UA-118778979-1"
            },
            "triggers": {
            "trackPageview": {
            "on": "visible",
            "request": "pageview"
            }
            }
            }
        </script>
    </amp-analytics>
    <header>
        <div class="menu content-width">
            <div class="logo">
                <a href="https://askgif.com/">
                    AskGif<sup>TM</sup>
                </a>
            </div>
            <button id="sidebar-menu-btn" on="tap:sidebar.toggle">☰</button>
        </div>
    </header>
    <amp-sidebar id="sidebar" layout="nodisplay" side="right">
        <div class="amp-custom-sidebar-header">
            <div role="button" aria-label="close sidebar" on="tap:sidebar.toggle" tabindex="0" id="sidebar-close">✕</div>
        </div>
        <ul class="sidebar-menu">
            <a href="https://askgif.com/" class="sidevar-nav-item">
                <li>Gifs</li>
            </a>
            <a href="https://askgif.com/blog/" class="sidevar-nav-item">
                <li>Blogs</li>
            </a>
        </ul>
    </amp-sidebar>
    <section class="content content-width" id="article-wrapper">
            <div class="article">
                <a href="/blog/1688/how-to-design-the-data-structures-for-a-social-network">
                    <h2 class="title">
                        How to Design the data structures for a social network
                    </h2>
                </a>

                <div class="author-info">
                    By <a href="">AskGif</a> | Nov 20, 2020
                </div>
                <div class="article-image">
                    <a href="/blog/1688/how-to-design-the-data-structures-for-a-social-network/">
                        <amp-img src="https://raw.githubusercontent.com/sumitc91/sumitc91.github.io/master/Blogs/031621dc-30c0-4e0d-ba31-1f20a3884f5c.jpg" layout="responsive" width="1484" height="600"></amp-img>
                        <p class="subtext">
                            Source : AskGif
                        </p>
                    </a>
                </div>
                <div class="article-meta">
                    <ul class="tags">
                        <a class="tag" href="/blog/category/tutorials/"><li>tutorials</li></a>
                            <a class="tag" href="/blog/tags/design/"><li>design</li></a>
                            <a class="tag" href="/blog/tags/interview/"><li>interview</li></a>
                            <a class="tag" href="/blog/tags/system-design/"><li>system-design</li></a>
                    </ul>
                </div>
                <div class="article-body">
                    <p><p>Step 1: Outline use cases and constraints<br />Gather requirements and scope the problem. Ask questions to clarify use cases and constraints. Discuss assumptions.</p>
<p>Without an interviewer to address clarifying questions, we'll define some use cases and constraints.</p>
<p>Use cases<br />We'll scope the problem to handle only the following use cases<br />User searches for someone and sees the shortest path to the searched person<br />Service has high availability<br />Constraints and assumptions</p>
<p><br />State assumptions<br />Traffic is not evenly distributed<br />Some searches are more popular than others, while others are only executed once<br />Graph data won't fit on a single machine<br />Graph edges are unweighted<br />100 million users<br />50 friends per user average<br />1 billion friend searches per month<br />Exercise the use of more traditional systems - don't use graph-specific solutions such as GraphQL or a graph database like Neo4j</p>
<p>Calculate usage<br />Clarify with your interviewer if you should run back-of-the-envelope usage calculations.</p>
<p>5 billion friend relationships<br />100 million users * 50 friends per user average<br />400 search requests per second<br />Handy conversion guide:</p>
<p>2.5 million seconds per month<br />1 request per second = 2.5 million requests per month<br />40 requests per second = 100 million requests per month<br />400 requests per second = 1 billion requests per month<br />Step 2: Create a high level design<br />Outline a high level design with all important components.</p>
<p>Imgur</p>
<p>Step 3: Design core components<br />Dive into details for each core component.</p>
<p>Use case: User searches for someone and sees the shortest path to the searched person<br />Clarify with your interviewer how much code you are expected to write.</p>
<p>Without the constraint of millions of users (vertices) and billions of friend relationships (edges), we could solve this unweighted shortest path task with a general BFS approach:</p>
<p>class Graph(Graph):</p>
<p>&nbsp; &nbsp; def shortest_path(self, source, dest):<br />&nbsp; &nbsp; &nbsp; &nbsp; if source is None or dest is None:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return None<br />&nbsp; &nbsp; &nbsp; &nbsp; if source is dest:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return [source.key]<br />&nbsp; &nbsp; &nbsp; &nbsp; prev_node_keys = self._shortest_path(source, dest)<br />&nbsp; &nbsp; &nbsp; &nbsp; if prev_node_keys is None:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return None<br />&nbsp; &nbsp; &nbsp; &nbsp; else:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; path_ids = [dest.key]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; prev_node_key = prev_node_keys[dest.key]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while prev_node_key is not None:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; path_ids.append(prev_node_key)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; prev_node_key = prev_node_keys[prev_node_key]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return path_ids[::-1]</p>
<p>&nbsp; &nbsp; def _shortest_path(self, source, dest):<br />&nbsp; &nbsp; &nbsp; &nbsp; queue = deque()<br />&nbsp; &nbsp; &nbsp; &nbsp; queue.append(source)<br />&nbsp; &nbsp; &nbsp; &nbsp; prev_node_keys = {source.key: None}<br />&nbsp; &nbsp; &nbsp; &nbsp; source.visit_state = State.visited<br />&nbsp; &nbsp; &nbsp; &nbsp; while queue:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node = queue.popleft()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if node is dest:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return prev_node_keys<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; prev_node = node<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for adj_node in node.adj_nodes.values():<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if adj_node.visit_state == State.unvisited:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; queue.append(adj_node)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; prev_node_keys[adj_node.key] = prev_node.key<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; adj_node.visit_state = State.visited<br />&nbsp; &nbsp; &nbsp; &nbsp; return None<br />We won't be able to fit all users on the same machine, we'll need to shard users across Person Servers and access them with a Lookup Service.</p>
<p>The Client sends a request to the Web Server, running as a reverse proxy<br />The Web Server forwards the request to the Search API server<br />The Search API server forwards the request to the User Graph Service<br />The User Graph Service does the following:<br />Uses the Lookup Service to find the Person Server where the current user's info is stored<br />Finds the appropriate Person Server to retrieve the current user's list of friend_ids<br />Runs a BFS search using the current user as the source and the current user's friend_ids as the ids for each adjacent_node<br />To get the adjacent_node from a given id:<br />The User Graph Service will again need to communicate with the Lookup Service to determine which Person Server stores theadjacent_node matching the given id (potential for optimization)<br />Clarify with your interviewer how much code you should be writing.</p>
<p>Note: Error handling is excluded below for simplicity. Ask if you should code proper error handing.</p>
<p>Lookup Service implementation:</p>
<p>class LookupService(object):</p>
<p>&nbsp; &nbsp; def __init__(self):<br />&nbsp; &nbsp; &nbsp; &nbsp; self.lookup = self._init_lookup() &nbsp;# key: person_id, value: person_server</p>
<p>&nbsp; &nbsp; def _init_lookup(self):<br />&nbsp; &nbsp; &nbsp; &nbsp; ...</p>
<p>&nbsp; &nbsp; def lookup_person_server(self, person_id):<br />&nbsp; &nbsp; &nbsp; &nbsp; return self.lookup[person_id]<br />Person Server implementation:</p>
<p>class PersonServer(object):</p>
<p>&nbsp; &nbsp; def __init__(self):<br />&nbsp; &nbsp; &nbsp; &nbsp; self.people = {} &nbsp;# key: person_id, value: person</p>
<p>&nbsp; &nbsp; def add_person(self, person):<br />&nbsp; &nbsp; &nbsp; &nbsp; ...</p>
<p>&nbsp; &nbsp; def people(self, ids):<br />&nbsp; &nbsp; &nbsp; &nbsp; results = []<br />&nbsp; &nbsp; &nbsp; &nbsp; for id in ids:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if id in self.people:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; results.append(self.people[id])<br />&nbsp; &nbsp; &nbsp; &nbsp; return results<br />Person implementation:</p>
<p>class Person(object):</p>
<p>&nbsp; &nbsp; def __init__(self, id, name, friend_ids):<br />&nbsp; &nbsp; &nbsp; &nbsp; self.id = id<br />&nbsp; &nbsp; &nbsp; &nbsp; self.name = name<br />&nbsp; &nbsp; &nbsp; &nbsp; self.friend_ids = friend_ids<br />User Graph Service implementation:</p>
<p>class UserGraphService(object):</p>
<p>&nbsp; &nbsp; def __init__(self, lookup_service):<br />&nbsp; &nbsp; &nbsp; &nbsp; self.lookup_service = lookup_service</p>
<p>&nbsp; &nbsp; def person(self, person_id):<br />&nbsp; &nbsp; &nbsp; &nbsp; person_server = self.lookup_service.lookup_person_server(person_id)<br />&nbsp; &nbsp; &nbsp; &nbsp; return person_server.people([person_id])</p>
<p>&nbsp; &nbsp; def shortest_path(self, source_key, dest_key):<br />&nbsp; &nbsp; &nbsp; &nbsp; if source_key is None or dest_key is None:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return None<br />&nbsp; &nbsp; &nbsp; &nbsp; if source_key is dest_key:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return [source_key]<br />&nbsp; &nbsp; &nbsp; &nbsp; prev_node_keys = self._shortest_path(source_key, dest_key)<br />&nbsp; &nbsp; &nbsp; &nbsp; if prev_node_keys is None:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return None<br />&nbsp; &nbsp; &nbsp; &nbsp; else:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Iterate through the path_ids backwards, starting at dest_key<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; path_ids = [dest_key]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; prev_node_key = prev_node_keys[dest_key]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while prev_node_key is not None:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; path_ids.append(prev_node_key)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; prev_node_key = prev_node_keys[prev_node_key]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Reverse the list since we iterated backwards<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return path_ids[::-1]</p>
<p>&nbsp; &nbsp; def _shortest_path(self, source_key, dest_key, path):<br />&nbsp; &nbsp; &nbsp; &nbsp; # Use the id to get the Person<br />&nbsp; &nbsp; &nbsp; &nbsp; source = self.person(source_key)<br />&nbsp; &nbsp; &nbsp; &nbsp; # Update our bfs queue<br />&nbsp; &nbsp; &nbsp; &nbsp; queue = deque()<br />&nbsp; &nbsp; &nbsp; &nbsp; queue.append(source)<br />&nbsp; &nbsp; &nbsp; &nbsp; # prev_node_keys keeps track of each hop from<br />&nbsp; &nbsp; &nbsp; &nbsp; # the source_key to the dest_key<br />&nbsp; &nbsp; &nbsp; &nbsp; prev_node_keys = {source_key: None}<br />&nbsp; &nbsp; &nbsp; &nbsp; # We'll use visited_ids to keep track of which nodes we've<br />&nbsp; &nbsp; &nbsp; &nbsp; # visited, which can be different from a typical bfs where<br />&nbsp; &nbsp; &nbsp; &nbsp; # this can be stored in the node itself<br />&nbsp; &nbsp; &nbsp; &nbsp; visited_ids = set()<br />&nbsp; &nbsp; &nbsp; &nbsp; visited_ids.add(source.id)<br />&nbsp; &nbsp; &nbsp; &nbsp; while queue:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; node = queue.popleft()<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if node.key is dest_key:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return prev_node_keys<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; prev_node = node<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for friend_id in node.friend_ids:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if friend_id not in visited_ids:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; friend_node = self.person(friend_id)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; queue.append(friend_node)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; prev_node_keys[friend_id] = prev_node.key<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; visited_ids.add(friend_id)<br />&nbsp; &nbsp; &nbsp; &nbsp; return None<br />We'll use a public REST API:</p>
<p>$ curl https://social.com/api/v1/friend_search?person_id=1234<br />Response:</p>
<p>{<br />&nbsp; &nbsp; "person_id": "100",<br />&nbsp; &nbsp; "name": "foo",<br />&nbsp; &nbsp; "link": "https://social.com/foo",<br />},<br />{<br />&nbsp; &nbsp; "person_id": "53",<br />&nbsp; &nbsp; "name": "bar",<br />&nbsp; &nbsp; "link": "https://social.com/bar",<br />},<br />{<br />&nbsp; &nbsp; "person_id": "1234",<br />&nbsp; &nbsp; "name": "baz",<br />&nbsp; &nbsp; "link": "https://social.com/baz",<br />},<br />For internal communications, we could use Remote Procedure Calls.</p>
<p>Step 4: Scale the design<br />Identify and address bottlenecks, given the constraints.</p>
<p>Imgur</p>
<p>Important: Do not simply jump right into the final design from the initial design!</p>
<p>State you would 1) Benchmark/Load Test, 2) Profile for bottlenecks 3) address bottlenecks while evaluating alternatives and trade-offs, and 4) repeat. See Design a system that scales to millions of users on AWS as a sample on how to iteratively scale the initial design.</p>
<p>It's important to discuss what bottlenecks you might encounter with the initial design and how you might address each of them. For example, what issues are addressed by adding a Load Balancer with multiple Web Servers? CDN? Master-Slave Replicas? What are the alternatives and Trade-Offs for each?</p>
<p>We'll introduce some components to complete the design and to address scalability issues. Internal load balancers are not shown to reduce clutter.</p>
<p>To avoid repeating discussions, refer to the following system design topics for main talking points, tradeoffs, and alternatives:</p>
<p>DNS<br />Load balancer<br />Horizontal scaling<br />Web server (reverse proxy)<br />API server (application layer)<br />Cache<br />Consistency patterns<br />Availability patterns<br />To address the constraint of 400 average read requests per second (higher at peak), person data can be served from a Memory Cache such as Redis or Memcached to reduce response times and to reduce traffic to downstream services. This could be especially useful for people who do multiple searches in succession and for people who are well-connected. Reading 1 MB sequentially from memory takes about 250 microseconds, while reading from SSD takes 4x and from disk takes 80x longer.1</p>
<p>Below are further optimizations:</p>
<p>Store complete or partial BFS traversals to speed up subsequent lookups in the Memory Cache<br />Batch compute offline then store complete or partial BFS traversals to speed up subsequent lookups in a NoSQL Database<br />Reduce machine jumps by batching together friend lookups hosted on the same Person Server<br />Shard Person Servers by location to further improve this, as friends generally live closer to each other<br />Do two BFS searches at the same time, one starting from the source, and one from the destination, then merge the two paths<br />Start the BFS search from people with large numbers of friends, as they are more likely to reduce the number of degrees of separation between the current user and the search target<br />Set a limit based on time or number of hops before asking the user if they want to continue searching, as searching could take a considerable amount of time in some cases<br />Use a Graph Database such as Neo4j or a graph-specific query language such as GraphQL (if there were no constraint preventing the use of Graph Databases)</p></p>
                     <amp-ad width="100vw" height="320"
                            type="adsense"
                            data-ad-client="ca-pub-1068871795581451"
                            data-ad-slot="7001708883"
                            data-auto-format="rspv"
                            data-full-width="">
                        <div overflow=""></div>
                    </amp-ad> 

                     <amp-ad width="100vw" height="320"
                            type="adsense"
                            data-ad-client="ca-pub-1068871795581451"
                            data-ad-slot="7001708883"
                            data-auto-format="rspv"
                            data-full-width="">
                        <div overflow=""></div>
                    </amp-ad> 
                </div>
            </div>

        <div class="article">
            <div class="article-meta">
                <ul class="tags">
                </ul>

            </div>
        </div>

        <div id="additional-info">
                <div class="related-box promo">
                    <a href="/blog/31/what-is-asymptotic-analysis-and-how-to-calculate-it/">
                        <amp-img src="https://raw.githubusercontent.com/sumitc91/sumitc91.github.io/master/Blogs/e2bab25d-22ad-45ac-baf5-67649dfc6f67_asymptotic-analysis.png" layout="responsive" width="1484" height="600"></amp-img>
                    </a>
                    <p><a href="/blog/31/what-is-asymptotic-analysis-and-how-to-calculate-it/">What is Asymptotic Analysis and how to calculate it?</a></p>
                </div>
                <div class="related-box promo">
                    <a href="/blog/104/how-to-implement-inorder-traversal-in-binary-tree/">
                        <amp-img src="https://raw.githubusercontent.com/sumitc91/sumitc91.github.io/master/Blogs/bf7ea477-0b3a-4e79-9923-feb2fab2a727_inorder_traversal in Java.jpg" layout="responsive" width="1484" height="600"></amp-img>
                    </a>
                    <p><a href="/blog/104/how-to-implement-inorder-traversal-in-binary-tree/">How to implement InOrder Traversal in Binary Tree?</a></p>
                </div>
                <div class="related-box promo">
                    <a href="/blog/1689/how-to-design-amazons-sales-rank-by-category-feature/">
                        <amp-img src="https://raw.githubusercontent.com/sumitc91/sumitc91.github.io/master/Blogs/icon_6a724e39-5b07-478b-a4ae-af8ecae9210e.jpg" layout="responsive" width="1484" height="600"></amp-img>
                    </a>
                    <p><a href="/blog/1689/how-to-design-amazons-sales-rank-by-category-feature/">How to Design Amazon&#x27;s sales rank by category feature</a></p>
                </div>
                <div class="related-box promo">
                    <a href="/blog/1700/asynchronism-tutorial/">
                        <amp-img src="https://raw.githubusercontent.com/sumitc91/sumitc91.github.io/master/Blogs/icon_0b59af20-c986-4d3f-b12b-304dc3797df3.png" layout="responsive" width="1484" height="600"></amp-img>
                    </a>
                    <p><a href="/blog/1700/asynchronism-tutorial/">Asynchronism Tutorial</a></p>
                </div>
             <amp-ad width="100vw" height="320"
                    type="adsense"
                    data-ad-client="ca-pub-1068871795581451"
                    data-ad-slot="7001708883"
                    data-auto-format="rspv"
                    data-full-width="">
                <div overflow=""></div>
            </amp-ad> 

            <div class="related-box">
                <h3>Categories</h3>
                <ul>
                </ul>
            </div>
            <div class="related-box promo">
                 <amp-ad width="100vw" height="320"
                        type="adsense"
                        data-ad-client="ca-pub-1068871795581451"
                        data-ad-slot="7001708883"
                        data-auto-format="rspv"
                        data-full-width="">
                    <div overflow=""></div>
                </amp-ad> 
            </div>
        </div>
    </section>

    <footer>
        <div class="content content-width">
            <div class="footer-menu">
                <div class="footer-item">
                    <h2>About AskGif</h2>
                    <p>
                        AskGif is an honest to GOD approach to bring little smile on the tense faces. Make sure to play your part in our mission
                        to make people smile. Keep smiling and keep sharing
                    </p><br>
                    <a href="https://askgif.com/about-us/">Read More</a>
                </div>
                <div class="footer-item">
                    <h2>Sarkari Support &amp; Help</h2>
                    <ul>
                        <li><a href="https://askgif.com/faq/">FAQs</a></li>
                        <li>Have Questions? Email us @ support[at]askgif[dot]com</li>
                    </ul>
                </div>
                <div class="footer-item">
                    <h2>Follow us</h2>
                    <p>Adhe Idhar Jao Adhe Udhar Jao</p>
                    <p>Baki hamare piche ao</p>
                </div>
                <div class="footer-item">
                    <h2>Quick Links</h2>
                    <ul>
                        <li><a href="https://askgif.com/?lang=en">English</a></li>
                        <li><a href="https://askgif.com/?lang=hi">हिंदी</a></li>
                        <li><a href="https://askgif.com/terms-of-service/">Terms of Service</a></li>
                        <li><a href="https://askgif.com/privacy-policy/">Privacy Policy</a></li>
                        <li><a href="https://askgif.com/editor/">Editor</a></li>
                        <li><a href="https://askgif.com/contributors/">Developers & Contributors</a></li>
                        <li><a href="https://askgif.com/sitemap.xml">Site Map</a></li>
                    </ul>
                </div>
            </div>
            <div class="social">
                <ul>
                    <li><a rel="ugc nofollow" href="https://www.facebook.com/askgifdotcom/"><i class="fab fa-facebook-f"></i></a></li>
                    <li><a rel="ugc nofollow" href="https://twitter.com/askgifdotcom"><i class="fab fa-twitter"></i></a></li>
                    <li><a rel="ugc nofollow" href="https://www.pinterest.com/askgifdotcom/"><i class="fab fa-pinterest"></i></a></li>
                    <li><a rel="ugc nofollow" href="https://www.instagram.com/askgifdotcom/"><i class="fab fa-instagram"></i></a></li>
                    <li><a rel="ugc nofollow" href="https://www.tumblr.com/blog/askgifdotcom"><i class="fab fa-tumblr"></i></a></li>
                </ul>
            </div>

            <div class="meta-content">
                <p>Copyright 2021 | Designed by <a href="https://askgif.com/">Askgif</a> | Last Cached: 10/30/2021 9:42:29 AM | A</p>
            </div>
        </div>
    </footer>
</body>

</html>

